#!/bin/sh

# SPDX-License-Identifier: GPL-2.0-or-later
# Copyright (C) 2025 ROCKNIX

# Serial device
SERIAL_DEVICE="/dev/ttyHS0"

# Open serial device
exec 20<>$SERIAL_DEVICE
stty -F $SERIAL_DEVICE 115200 -opost -isig -icanon -echo

# Send frame to switch gampead to fake xbox 360 controller
printf "\xe7\x55\x05\x01\x00\x00\x00\x00\x00\x5b\xed" > /dev/ttyHS0
printf "\x35\x35\x30\x35\x30\x31\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30" > /dev/ttyHS0

# Close serial device
exec 20>&-